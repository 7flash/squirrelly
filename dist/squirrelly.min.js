!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).Sqrl={})}(this,function(e){"use strict";var r=Object.freeze({get H(){return n},get Compile(){return S},get defineFilter(){return k},get defineHelper(){return q},get defineNativeHelper(){return O},get definePartial(){return E},get Render(){return b},get renderFile(){return C},get load(){return P},get __express(){return I},get F(){return h},get setDefaultFilters(){return w},get autoEscaping(){return m},get defaultTags(){return u}}),n={},t=/{{ *?(?:(?:(?:(?:([\w$]+ *?(?:[^\s\w($][^\n]*?)*?))|(?:@(?:([\w$]+:|(?:\.\.\/)+))? *(.+?) *))(?: *?(\| *?[\w$]+? *?)+?)?)|(?:([\w$]+) *?\(([^\n]*?)\) *?([\w$]*))|(?:\/ *?([\w$]+))|(?:# *?([\w$]+))|(?:([\w$]+) *?\(([^\n]*?)\) *?\/)|(?:!--[^]+?--)) *?}}\n?/g,i={s:"{{",e:"}}"},l=/"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'|[\\]@(?:[\w$]*:)?[\w$]+|@(?:([\w$]*):)?([\w$]+)/g,a=t,s=i;function u(e){o(e[0],e[1]),t=a,i=s}function o(e,r){var n=e+a.source.slice(s.s.length,0-(s.e.length+3))+r+"\\n?",t=a.lastIndex;s={s:e,e:r},(a=RegExp(n,"g")).lastIndex=t}function f(e){return e=e.replace(l,function(e,r,n){return void 0===n?e:(void 0===r&&(r=""),"hvals"+r+"."+n)})}var c={if:{helperStart:function(e){return"if("+e+"){"},helperEnd:function(){return"}"},blocks:{else:function(){return"}else{"}}},each:{helperStart:function(e,r){return"for(var i=0;i<"+e+".length; i++){tR+=(function(hvals){var tR='';var hvals"+r+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[i],index:i})};"}},foreach:{helperStart:function(e,r){return"for(var key in "+e+"){if(!"+e+".hasOwnProperty(key)) continue;tR+=(function(hvals){var tR='';var hvals"+r+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[key], key: key})};"}},log:{selfClosing:function(e){return"console.log("+e+");"}},tags:{selfClosing:function(e){return o(e.slice(0,e.indexOf(",")).trim(),e.slice(e.indexOf(",")+1).trim()),""}},js:{selfClosing:function(e){return e+";"}}},d={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function v(e){return d[e]}var g=/[&<"']/g,p=/[&<"']/,h={e:function(e){var r=String(e);return p.test(r)?r.replace(g,v):r}},R={},x={start:"",end:""};function w(e){if("clear"===e)R={};else for(var r in e)e.hasOwnProperty(r)&&(R[r]=e[r]);!function(){for(var e in x={start:"",end:""},R)R.hasOwnProperty(e)&&R[e]&&(x.start+="Sqrl.F."+e+"(",x.end+=")")}()}var y=!0;function m(e){return y=e}function $(e,r){var n,t=!1,i="",l="";if(r&&""!==r){n=r.split("|");for(var a=0;a<n.length;a++)n[a]=n[a].trim(),""!==n[a]&&("safe"!==n[a]?(i="Sqrl.F."+n[a]+"("+i,l+=")"):t=!0)}return i+=x.start,l+=x.end,!t&&y&&(i+="Sqrl.F.e(",l+=")"),i+e+l}var F={};function S(e){var r,n=0,l="",u=[],o=-1,d=0,v={};for(s=i,(a=t).lastIndex=0;null!==(r=a.exec(e));){if(""===l?l+="var tR='"+e.slice(n,r.index).replace(/'/g,"\\'")+"';":n!==r.index&&(l+="tR+='"+e.slice(n,r.index).replace(/'/g,"\\'")+"';"),n=r[0].length+r.index,r[1])l+="tR+="+O(r[1],r[4])+";";else if(r[3])l+="tR+="+b(r[3],r[2],r[4])+";";else if(r[5]){var g=r[7];""!==g&&null!==g||(g=d,d++);var p=c.hasOwnProperty(r[5]);o+=1;var h=r[6]||"";h=f(h),p||(h="["+h+"]");var R={name:r[5],id:g,params:h,native:p};u[o]=R,p?(l+=c[r[5]].helperStart(h,g),n=a.lastIndex):l+="tR+=Sqrl.H."+r[5]+"("+h+",function(hvals){var hvals"+g+"=hvals;var tR='';"}else if(r[8]){var x=u[o];x&&x.name===r[8]?(o-=1,!0===x.native?l+=c[x.name].helperEnd(x.params,x.id):v[x.id]?l+="return tR}});":l+="return tR});"):console.error("Helper beginning & end don't match.")}else if(r[9]){var w=u[o];if(w.native){var y=c[w.name];y.blocks&&y.blocks[r[9]]?(l+=y.blocks[r[9]](w.id),n=a.lastIndex):console.warn("Native helper '%s' doesn't accept that block.",w.name)}else v[w.id]?l+="return tR},"+r[9]+":function(hvals){var hvals"+w.id+"=hvals;var tR='';":(l+="return tR},{"+r[9]+":function(hvals){var hvals"+w.id+"=hvals;var tR='';",v[w.id]=!0)}else if(r[10]){var m=r[11]||"";if(m=f(m),"include"===r[10]){var S=e.slice(0,r.index),k=e.slice(r.index+r[0].length),q=m.replace(/'|"/g,"");e=S+F[q]+k,n=a.lastIndex=r.index}else c.hasOwnProperty(r[10])&&c[r[10]].hasOwnProperty("selfClosing")?(l+=c[r[10]].selfClosing(m),n=a.lastIndex):l+="tR+=Sqrl.H."+r[10]+"("+m+");"}function O(e,r){return $("options."+e,r)}function b(e,r,n){return $(void 0!==r?"hvals"+(/(?:\.\.\/)+/g.test(r)?u[o-r.length/3-1].id:r.slice(0,-1))+"."+e:"hvals."+e,n)}}return""===l?l+="var tR='"+e.slice(n,e.length).replace(/'/g,"\\'")+"';":n!==e.length&&(l+="tR+='"+e.slice(n,e.length).replace(/'/g,"\\'")+"';"),l+="return tR",new Function("options","Sqrl",l.replace(/\n/g,"\\n").replace(/\r/g,"\\r"))}function k(e,r){h[e]=r}function q(e,r){n[e]=r}function O(e,r){c[e]=r}function b(e,n){return"function"==typeof e?e(n,r):"string"==typeof e?P(n,e)(n,r):void 0}function E(e,r){F[e]=r}var H={};function P(e,r){var n=e.$file,t=e.$name,i=e.$cache;if(!1===i){if(n)return S(require("fs").readFileSync(n,"utf8"));if(r)return S(r);throw Error("No template")}if(n){if(H[n])return H[n];var l=require("fs").readFileSync(n,"utf8");return H[n]=S(l),H[n]}return t?H[t]?H[t]:r?(H[t]=S(r),H[t]):void 0:r?!0===i?H[r]?H[r]:(H[r]=S(r),H[r]):S(r):"Error"}function C(e,n){return n.$file=e,P(n)(n,r)}function I(e,r,n){return n(null,C(e,r))}e.Compile=S,e.F=h,e.H=n,e.Render=b,e.__express=I,e.autoEscaping=m,e.defaultTags=u,e.defineFilter=k,e.defineHelper=q,e.defineNativeHelper=O,e.definePartial=E,e.load=P,e.renderFile=C,e.setDefaultFilters=w,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=squirrelly.min.js.map
