!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).Sqrl={})}(this,function(e){"use strict";var n={},r={},t=/{{ *?(?:(?:(?:(?:([\w$]+ *?(?:[^\s\w($][^\n]*?)*?))|(?:@(?:([\w$]+:|(?:\.\.\/)+))? *(.+?) *))(?: *?(\| *?[\w$]+? *?)+?)?)|(?:([\w$]+) *?\(([^\n]*?)\) *?([\w$]*))|(?:\/ *?([\w$]+))|(?:# *?([\w$]+))|(?:([\w$]+) *?\(([^\n]*?)\) *?\/)|(?:!--[^]+?--)) *?}}\n?/g,i={s:"{{",e:"}}"},l=/"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'|[\\]@(?:[\w$]*:)?[\w$]+|@(?:([\w$]*):)?([\w$]+)/g,a=t,s=i;function o(e,n){var r=e+a.source.slice(s.s.length,0-(s.e.length+3))+n+"\\n?",t=a.lastIndex;s={s:e,e:n},(a=RegExp(r,"g")).lastIndex=t}function f(e){return e=e.replace(l,function(e,n,r){return void 0===r?e:(void 0===n&&(n=""),"hvals"+n+"."+r)})}var u={if:{helperStart:function(e){return"if("+e+"){"},helperEnd:function(){return"}"},blocks:{else:function(){return"}else{"}}},each:{helperStart:function(e,n){return"for(var i=0;i<"+e+".length; i++){tR+=(function(hvals){var tR='';var hvals"+n+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[i],index:i})};"}},foreach:{helperStart:function(e,n){return"for(var key in "+e+"){if(!"+e+".hasOwnProperty(key)) continue;tR+=(function(hvals){var tR='';var hvals"+n+"=hvals;"},helperEnd:function(e){return"return tR})({this:"+e+"[key], key: key})};"}},log:{selfClosing:function(e){return"console.log("+e+");"}},tags:{selfClosing:function(e){return o(e.slice(0,e.indexOf(",")).trim(),e.slice(e.indexOf(",")+1).trim()),""}},js:{selfClosing:function(e){return e+";"}}},c={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function v(e){return c[e]}var d=/[&<"']/g,h=/[&<"']/,p={e:function(e){var n=String(e);return h.test(n)?n.replace(d,v):n}},g={},R={start:"",end:""};var x=!0;function w(e,n){var r,t=!1,i="",l="";if(n&&""!==n){r=n.split("|");for(var a=0;a<r.length;a++)r[a]=r[a].trim(),""!==r[a]&&("safe"!==r[a]?(i="Sqrl.F."+r[a]+"("+i,l+=")"):t=!0)}return i+=R.start,l+=R.end,!t&&x&&(i+="Sqrl.F.e(",l+=")"),i+e+l}function y(e){var n,l=0,o="",c=[],v=-1,d=0,h={};for(s=i,(a=t).lastIndex=0;null!==(n=a.exec(e));){if(""===o?o+="var tR='"+e.slice(l,n.index).replace(/'/g,"\\'")+"';":l!==n.index&&(o+="tR+='"+e.slice(l,n.index).replace(/'/g,"\\'")+"';"),l=n[0].length+n.index,n[1])o+="tR+="+q(n[1],n[4])+";";else if(n[3])o+="tR+="+H(n[3],n[2],n[4])+";";else if(n[5]){var p=n[7];""!==p&&null!==p||(p=d,d++);var g=u.hasOwnProperty(n[5]);v+=1;var R=n[6]||"";R=f(R),g||(R="["+R+"]");var x={name:n[5],id:p,params:R,native:g};c[v]=x,g?(o+=u[n[5]].helperStart(R,p),l=a.lastIndex):o+="tR+=Sqrl.H."+n[5]+"("+R+",function(hvals){var hvals"+p+"=hvals;var tR='';"}else if(n[8]){var y=c[v];y&&y.name===n[8]?(v-=1,!0===y.native?o+=u[y.name].helperEnd(y.params,y.id):h[y.id]?o+="return tR}});":o+="return tR});"):console.error("Helper beginning & end don't match.")}else if(n[9]){var m=c[v];if(m.native){var $=u[m.name];$.blocks&&$.blocks[n[9]]?(o+=$.blocks[n[9]](m.id),l=a.lastIndex):console.warn("Native helper '%s' doesn't accept that block.",m.name)}else h[m.id]?o+="return tR},"+n[9]+":function(hvals){var hvals"+m.id+"=hvals;var tR='';":(o+="return tR},{"+n[9]+":function(hvals){var hvals"+m.id+"=hvals;var tR='';",h[m.id]=!0)}else if(n[10]){var S=n[11]||"";if(S=f(S),"include"===n[10]){var F=e.slice(0,n.index),P=e.slice(n.index+n[0].length),k=S.replace(/'|"/g,"");e=F+r[k]+P,l=a.lastIndex=n.index}else u.hasOwnProperty(n[10])&&u[n[10]].hasOwnProperty("selfClosing")?(o+=u[n[10]].selfClosing(S),l=a.lastIndex):o+="tR+=Sqrl.H."+n[10]+"("+S+");"}function q(e,n){return w("options."+e,n)}function H(e,n,r){return w(void 0!==n?"hvals"+(/(?:\.\.\/)+/g.test(n)?c[v-n.length/3-1].id:n.slice(0,-1))+"."+e:"hvals."+e,r)}}return""===o?o+="var tR='"+e.slice(l,e.length).replace(/'/g,"\\'")+"';":l!==e.length&&(o+="tR+='"+e.slice(l,e.length).replace(/'/g,"\\'")+"';"),o+="return tR",new Function("options","Sqrl",o.replace(/\n/g,"\\n").replace(/\r/g,"\\r"))}var m={};function $(e,n){var r=e.$file,t=e.$name,i=e.$cache;if(!1===i){if(r)return y(require("fs").readFileSync(r,"utf8"));if(n)return y(n);throw Error("No template")}if(r){if(m[r])return m[r];var l=require("fs").readFileSync(r,"utf8");return m[r]=y(l),m[r]}return t?m[t]?m[t]:n?(m[t]=y(n),m[t]):void 0:n?!0===i?m[n]?m[n]:(m[n]=y(n),m[n]):y(n):"Error"}function S(e,t){return t.$file=e,$(t)(t,{H:n,F:p,P:r})}e.Compile=y,e.F=p,e.H=n,e.P=r,e.Render=function(e,t){return"function"==typeof e?e(t,{H:n,F:p,P:r}):"string"==typeof e?$(t,e)(t,{H:n,F:p,P:r}):void 0},e.__express=function(e,n,r){return r(null,S(e,n))},e.autoEscaping=function(e){return x=e},e.defaultTags=function(e){o(e[0],e[1]),t=a,i=s},e.defineFilter=function(e,n){p[e]=n},e.defineHelper=function(e,r){n[e]=r},e.defineNativeHelper=function(e,n){u[e]=n},e.definePartial=function(e,n){r[e]=n},e.load=$,e.renderFile=S,e.setDefaultFilters=function(e){if("clear"===e)g={};else for(var n in e)e.hasOwnProperty(n)&&(g[n]=e[n]);!function(){for(var e in R={start:"",end:""},g)g.hasOwnProperty(e)&&g[e]&&(R.start+="Sqrl.F."+e+"(",R.end+=")")}()},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=squirrelly.min.js.map
