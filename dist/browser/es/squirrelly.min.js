function e(t){var r,n,a=new Error(t);return r=a,n=e.prototype,Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n,a}function t(t,r,n){var a=r.slice(0,n).split(/\n/),c=a.length,i=a[c-1].length+1;throw e(t+=" at line "+c+" col "+i+":\n\n  "+r.split(/\n/)[c-1]+"\n  "+Array(i).join(" ")+"^")}function r(e,r,n,a){var c=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+n+")","g"),i=new RegExp("([^]*?)"+r+"(-|_)?\\s*","g"),f=0,o="";function u(){var r,n={f:[]},a=0,u=e[f],l="c",s="r";function h(r){var a=e.slice(f,r),c=a.trim();if("f"===l)"safe"===c?n.raw=!0:n.f.push([c,""]);else if("fp"===l)n.f[n.f.length-1][1]+=c;else if("err"===l){if(c){var i=a.search(/\S/);t("invalid syntax",e,f+i)}}else n[l]=c;f=r+1}for(f+=1,"~"===u||"#"===u||"/"===u?(l="n",s=u):"!"===u||"?"===u?s=u:"*"===u?n.raw=!0:f-=1,c.lastIndex=f;null!==(r=c.exec(e));){var p=r[1],v=r[2],g=r[3],d=r[4],y=r.index;if(p)"("===p?(0===a&&("n"===l?(h(y),l="p"):"f"===l&&(h(y),l="fp")),a++):")"===p?0===--a&&"c"!==l&&(h(y),l="err"):0===a&&"|"===p?(h(y),l="f"):"=>"===p&&(h(y),f+=1,l="res");else if(v)return h(y),f=y+r[0].length,i.lastIndex=f,o=d,g&&"~"===s&&(s="s"),n.t=s,n}return t("unclosed tag",e,e.length),n}return function r(n,a){n.b=[],n.d=[];var c,l=!1,s=[];function h(e,t){if(e){var r=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");t&&(r=function(e,t){return"_"===t?String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):e.replace(/(?:[\s\uFEFF\xA0]|\r\n)$/,"")}(r,t)),o&&(r=function(e,t){return"_"===t?String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):e.replace(/^(?:[\s\uFEFF\xA0]|\r\n)/,"")}(r,o),o=""),s.push(r)}}for(;null!==(c=i.exec(e));){h(c[1],c[2]),f=c.index+c[0].length;var p=u(),v=p.t;if("~"===v)p=r(p),s.push(p);else if("/"===v){if(n.n===p.n)return l?(l.d=s,n.b.push(l)):n.d=s,n;t("Helper start and end don't match",e,c.index+c[0].length)}else"#"===v?(l?(l.d=s,n.b.push(l)):n.d=s,l=p,s=[]):s.push(p)}return a&&(h(e.slice(f,e.length)),n.d=s),n}({f:[]},!0).d}e.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var n=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.clear=function(){this.cache={}},e.prototype.load=function(e){this.cache=e},e}(),a=new n({}),c=new n({}),i=new n({each:function(e){for(var t="",r=e.params[0],n=0;n<r.length;n++)t+=e.exec(r[n],n);return t},foreach:function(e){var t="",r=e.params[0];for(var n in r)r.hasOwnProperty(n)&&(t+=e.exec(r,n));return t}}),f=new n({if:function(t,r){if(t.f&&t.f.length)throw e("native helper 'if' can't have filters");var n="if("+t.p+"){"+g(t.d,r)+"}";if(t.b)for(var a=0;a<t.b.length;a++){var c=t.b[a];"else"===c.n?n+="else{"+g(c.d,r)+"}":"elif"===c.n&&(n+="else if("+c.p+"){"+g(c.d,r)+"}")}return n},try:function(t,r){if(t.f&&t.f.length)throw e("native helper 'try' can't have filters");if(!t.b||1!==t.b.length||"catch"!==t.b[0].n)throw e("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+g(t.d,r)+"}",a=t.b[0];return n+="catch"+(a.res?"("+a.res+")":"")+"{"+g(a.d,r)+"}"}}),o={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function u(e){return o[e]}var l=new n({e:function(e){var t=String(e);return/[&<"']/.test(t)?t.replace(/[&<"']/g,u):t}});function s(e,t,n,a){return"var tR='';"+g(r(e,t,n),a).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function h(e,t,r,n,a){var c="{exec:"+v(r,t,e)+",params:["+n+"]";return a&&(c+=",name:'"+a+"'"),c+="}"}function p(e,t){for(var r="[",n=0;n<e.length;n++){var a=e[n];r+=h(t,a.res||"",a.d,a.p||"",a.n),n<e.length&&(r+=",")}return r+="]"}function v(e,t,r){return"function("+t+"){var tR='';"+g(e,r)+"return tR}"}function g(e,t){for(var r=0,n=e.length,a="";r<n;r++){var c=e[r];if("string"==typeof c){a+="tR+='"+c+"';"}else{var i=c.t,o=c.c||"",u=c.f,l=c.n||"",s=c.p||"",v=c.res||"",g=c.b;if("r"===i)!c.raw&&t.autoEscape&&(o='Sqrl.F.get("e")('+o+")"),a+="tR+="+d(o,u)+";";else if("~"===i)if(f.get(l))a+=f.get(l)(c,t);else{var y="Sqrl.H.get('"+l+"')("+h(t,v,c.d,s);g&&(y+=","+p(g,t)),a+="tR+="+d(y+=")",u)+";"}else"s"===i?a+="tR+="+d("Sqrl.H.get('"+l+"')("+s+")",u)+";":"!"===i&&(a+=o+";")}}return a}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r][0],a=t[r][1];e="Sqrl.F.get('"+n+"')("+e,a&&(e+=","+a),e+=")"}return e}var y={varName:"it",autoTrim:!1,autoEscape:!0,defaultFilter:!1},w={cache:{default:y},define:function(e,t){for(var r in this.cache[e]||(this.cache[e]=y),t)this.cache[e][r]=t[r]},get:function(e){return this.cache[e]},remove:function(e){delete this.cache[e]},clear:function(){this.cache={}},load:function(e){this.cache=e}};function m(e,t,r,n){var a=w.get(n||"default");return new Function(a.varName,"Sqrl",s(e,t,r,a))}function x(e,t,r,n){return r?"function"==typeof r&&(r=r(n)):r="default","function"==typeof e?e(t,{H:i,F:l}):m(e,"{{","}}",r)(t,{H:i,F:l})}export{m as Compile,s as CompileToString,w as Env,l as Filters,i as Helpers,a as Layouts,f as NativeHelpers,r as Parse,g as ParseScope,v as ParseScopeIntoFunction,c as Partials,x as Render};
//# sourceMappingURL=squirrelly.min.js.map
