function e(t){var r,n,c=new Error(t);return r=c,n=e.prototype,Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n,c}function t(t,r,n){var c=r.slice(0,n).split(/\n/),i=c.length,a=c[i-1].length+1;throw e(t+=" at line "+i+" col "+a+":\n\n  "+r.split(/\n/)[i-1]+"\n  "+Array(a).join(" ")+"^")}function r(e,r,n,c){var i=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+n+")","g"),a=new RegExp("([^]*?)"+r+"(-|_)?\\s*","g"),f=0,o="";function u(){var r,n={f:[],d:[]},c=0,u=0,l=e[f],s="c",h="r";function p(r,c){var i=e.slice(f,r)+(c||""),a=i.trim();if("f"===s)n.f[u-1][0]+=a;else if("fp"===s)n.f[u-1][1]+=a;else if("err"===s){if(a){var o=i.search(/\S/);t("invalid syntax",e,f+o)}}else s&&(n[s]=a);f=r+1}for(f+=1,"~"===l||"#"===l||"/"===l?(s="n",h=l):"!"===l||"?"===l?h=l:f-=1;null!==(r=i.exec(e));){var v=r[1],g=r[2],d=r[3],y=r[4],m=r.index;if(v)"("===v?(0===c&&("n"===s?(p(m),s="p"):"f"===s&&(p(m),s="fp")),c++):")"===v?0===--c&&"c"!==s&&(p(m),s="err"):0===c&&"|"===v?(p(m),s="f",u++,n.f[u-1]=["",""]):"=>"===v&&(p(m),f+=1,s="res");else if(g)return p(m),f+=g.length-1,a.lastIndex=f,o=y,d&&"~"===h&&(h="s"),n.t=h,n}return t("unclosed tag",e,e.length),n}return function r(n,c){n.b=[];var i,l=!1,s=[];function h(e,t){if(e){var r=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");t&&(r=function(e,t){return"_"===t?String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):e.replace(/(?:[\s\uFEFF\xA0]|\r\n)$/,"")}(r,t)),o&&(r=function(e,t){return"_"===t?String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):e.replace(/^(?:[\s\uFEFF\xA0]|\r\n)/,"")}(r,o),o=""),s.push(r)}}for(;null!==(i=a.exec(e));){h(i[1],i[2]),f=i.index+i[0].length;var p=u(),v=p.t;if("~"===v)p=r(p),s.push(p);else if("/"===v){if(n.n===p.n)return l?(l.d=s,n.b.push(l)):n.d=s,n;t("Helper start and end don't match",e,i.index+i[0].length)}else"#"===v?(l?(l.d=s,n.b.push(l)):n.d=s,l=p,s=[]):s.push(p)}return c&&(h(e.slice(f,e.length)),n.d=s),n}({f:[],d:[]},!0).d}e.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var n=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.clear=function(){this.cache={}},e.prototype.load=function(e){this.cache=e},e}(),c=new n({}),i=new n({}),a=new n({each:function(e){for(var t="",r=e.params[0],n=0;n<r.length;n++)t+=e.exec(r[n],n);return t},foreach:function(e){var t="",r=e.params[0];for(var n in r)r.hasOwnProperty(n)&&(t+=e.exec(r,n));return t}}),f=new n({if:function(t,r){if(t.f&&t.f.length)throw e("native helper 'if' can't have filters");var n="if("+t.p+"){"+g(t.d,r)+"}";if(t.b)for(var c=0;c<t.b.length;c++){var i=t.b[c];"else"===i.n?n+="else{"+g(i.d,r)+"}":"elif"===i.n&&(n+="else if("+i.p+"){"+g(i.d,r)+"}")}return n},try:function(t,r){if(t.f&&t.f.length)throw e("native helper 'try' can't have filters");if(!t.b||1!==t.b.length||"catch"!==t.b[0].n)throw e("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+g(t.d,r)+"}",c=t.b[0];return n+="catch"+(c.res?"("+c.res+")":"")+"{"+g(c.d,r)+"}"}}),o={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function u(e){return o[e]}var l=new n({e:function(e){var t=String(e);return/[&<"']/.test(t)?t.replace(/[&<"']/g,u):t}});function s(e,t,n,c){return"var tR='';"+g(r(e,t,n),c).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function h(e,t,r,n,c){var i="{exec:"+v(r,t,e)+",params:["+n+"]";return c&&(i+=",name:'"+c+"'"),i+="}"}function p(e,t){for(var r="[",n=0;n<e.length;n++){var c=e[n];r+=h(t,c.res||"",c.d||[],c.p||"",c.n||""),n<e.length&&(r+=",")}return r+="]"}function v(e,t,r){return"function("+t+"){var tR='';"+g(e,r)+"return tR}"}function g(e,t){for(var r=0,n=e.length,c="";r<n;r++){var i=e[r];if("string"==typeof i){c+="tR+='"+i+"';"}else{var a=i.t,o=i.c||"",u=i.f||[],l=i.n||"",s=i.p||"",v=i.res||"",g=i.b||[];if("r"===a)c+="tR+="+d(o,u)+";";else if("~"===a)if(f.get(l))c+=f.get(l)(i,t);else{var y="Sqrl.H.get('"+l+"')("+h(t,v,i.d,s);g&&(y+=","+p(g,t)),c+="tR+="+(y=d(y+=")",u))+";"}else"s"===a?c+="tR+="+d("Sqrl.H.get('"+l+"')("+s+")",u)+";":"!"===a&&(c+=o+";")}}return c}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r][0],c=t[r][1];e="Sqrl.F.get('"+n+"')("+e,c&&(e+=","+c),e+=")"}return e}var y={varName:"it",autoTrim:!1,autoEscape:!0,defaultFilter:!1},m={cache:{default:y},define:function(e,t){for(var r in this.cache[e]||(this.cache[e]=y),t)this.cache[e][r]=t[r]},get:function(e){return this.cache[e]},remove:function(e){delete this.cache[e]},clear:function(){this.cache={}},load:function(e){this.cache=e}};function w(e,t,r,n){var c=m.get(n||"default");return new Function(c.varName,"Sqrl",s(e,t,r,c))}function x(e,t,r,n){return r?"function"==typeof r&&(r=r(n)):r="default","function"==typeof e?e(t,{H:a,F:l}):w(e,"{{","}}",r)(t,{H:a,F:l})}export{w as Compile,s as CompileToString,m as Env,l as Filters,a as Helpers,c as Layouts,f as NativeHelpers,r as Parse,g as ParseScope,v as ParseScopeIntoFunction,i as Partials,x as Render};
//# sourceMappingURL=squirrelly.min.js.map
