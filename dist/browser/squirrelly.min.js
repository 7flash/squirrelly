!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).Sqrl={})}(this,(function(e){"use strict";function r(e){var t,n,a=new Error(e);return t=a,n=r.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n,a}function t(e,t,n){var a=t.slice(0,n).split(/\n/),o=a.length,i=a[o-1].length+1;throw r(e+=" at line "+o+" col "+i+":\n\n  "+t.split(/\n/)[o-1]+"\n  "+Array(i).join(" ")+"^")}function n(e,n){var a=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+n.tags[1]+")","g"),o=new RegExp("([^]*?)"+n.tags[0]+"(-|_)?\\s*","g"),i=0,c="";function f(){var r,n={f:[]},f=0,u=e[i],s="c",l="r";function p(r){var a=e.slice(i,r),o=a.trim();if("f"===s)"safe"===o?n.raw=!0:n.f.push([o,""]);else if("fp"===s)n.f[n.f.length-1][1]+=o;else if("err"===s){if(o){var c=a.search(/\S/);t("invalid syntax",e,i+c)}}else n[s]=o;i=r+1}for(i+=1,"~"===u||"#"===u||"/"===u?(s="n",l=u):"!"===u||"?"===u?l=u:"*"===u?n.raw=!0:i-=1,a.lastIndex=i;null!==(r=a.exec(e));){var h=r[1],g=r[2],v=r[3],d=r[4],m=r.index;if(h)"("===h?(0===f&&("n"===s?(p(m),s="p"):"f"===s&&(p(m),s="fp")),f++):")"===h?0===--f&&"c"!==s&&(p(m),s="err"):0===f&&"|"===h?(p(m),s="f"):"=>"===h&&(p(m),i+=1,s="res");else if(g)return p(m),i=m+r[0].length,o.lastIndex=i,c=d,v&&"~"===l&&(l="s"),n.t=l,n}return t("unclosed tag",e,e.length),n}return function a(u,s){u.b=[],u.d=[];var l,p=!1,h=[];function g(e,r){if(e){var t=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");(t=function(e,r,t,n){var a,o;return"string"==typeof r.autoTrim?a=o=r.autoTrim:Array.isArray(r.autoTrim)&&(a=r.autoTrim[1],o=r.autoTrim[0]),t&&(a=t),n&&(o=n),"slurp"===a&&"slurp"===o||!0===a&&!0===o?e.trim():("_"===a||"slurp"===a||!0===a?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==a&&"nl"!==a||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===o||"slurp"===o||!0===o?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==o&&"nl"!==o||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(t,n,c,r))&&h.push(t)}}for(;null!==(l=o.exec(e));){g(l[1],l[2]),i=l.index+l[0].length;var v=f(),d=v.t;if("~"===d)v=a(v),h.push(v);else if("/"===d){if(u.n===v.n)return p?(p.d=h,u.b.push(p)):u.d=h,u;t("Helper start and end don't match",e,l.index+l[0].length)}else"#"===d?(p?(p.d=h,u.b.push(p)):u.d=h,p=v,h=[]):h.push(v)}if(!s)throw r('unclosed helper "'+u.n+'"');return(g(e.slice(i,e.length)),u.d=h,u)}({f:[]},!0).d}r.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var a=function(){function e(e){this.cache=e}return e.prototype.define=function(e,r){this.cache[e]=r},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){for(var r in e)e.hasOwnProperty(r)&&(this.cache[r]=e[r])},e}(),o=new a({}),i=new a({each:function(e){for(var r="",t=e.params[0],n=0;n<t.length;n++)r+=e.exec(t[n],n);return r},foreach:function(e){var r="",t=e.params[0];for(var n in t)t.hasOwnProperty(n)&&(r+=e.exec(n,t[n]));return r}}),c=new a({if:function(e,t){if(e.f&&e.f.length)throw r("native helper 'if' can't have filters");var n="if("+e.p+"){"+v(e.d,t)+"}";if(e.b)for(var a=0;a<e.b.length;a++){var o=e.b[a];"else"===o.n?n+="else{"+v(o.d,t)+"}":"elif"===o.n&&(n+="else if("+o.p+"){"+v(o.d,t)+"}")}return n},try:function(e,t){if(e.f&&e.f.length)throw r("native helper 'try' can't have filters");if(!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw r("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+v(e.d,t)+"}",a=e.b[0];return n+="catch"+(a.res?"("+a.res+")":"")+"{"+v(a.d,t)+"}"}}),f={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function u(e){return f[e]}var s=new a({e:function(e){var r=String(e);return/[&<"']/.test(r)?r.replace(/[&<"']/g,u):r}});function l(e,r){return"var tR='';"+v(n(e,r),r).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function p(e,r,t,n,a){var o="{exec:"+g(t,r,e)+",params:["+n+"]";return a&&(o+=",name:'"+a+"'"),o+="}"}function h(e,r){for(var t="[",n=0;n<e.length;n++){var a=e[n];t+=p(r,a.res||"",a.d,a.p||"",a.n),n<e.length&&(t+=",")}return t+="]"}function g(e,r,t){return"function("+r+"){var tR='';"+v(e,t)+"return tR}"}function v(e,r){for(var t=0,n=e.length,a="";t<n;t++){var o=e[t];if("string"==typeof o){a+="tR+='"+o+"';"}else{var i=o.t,f=o.c||"",u=o.f,s=o.n||"",l=o.p||"",g=o.res||"",v=o.b;if("r"===i)!o.raw&&r.autoEscape&&(f="c.l('F','e')("+f+")"),a+="tR+="+d(f,u)+";";else if("~"===i)if(c.get(s))a+=c.get(s)(o,r);else{var m="c.l('H','"+s+"')("+p(r,g,o.d,l);m+=v?","+h(v,r):",[]",a+="tR+="+d(m+=",c)",u)+";"}else"s"===i?a+="tR+="+d("c.l('H','"+s+"')({params:["+l+"]},[],c)",u)+";":"!"===i&&(a+=f+";")}}return a}function d(e,r){for(var t=0;t<r.length;t++){var n=r[t][0],a=r[t][1];e="c.l('F','"+n+"')("+e,a&&(e+=","+a),e+=")"}return e}var m={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,r){return"H"===e?i.get(r):"F"===e?s.get(r):void 0},async:!1,cache:!1,plugins:{processAST:[],processFuncString:[]}};function y(e){var r={varName:m.varName,autoTrim:m.autoTrim,autoEscape:m.autoEscape,defaultFilter:m.defaultFilter,tags:m.tags,l:m.l,async:m.async,cache:m.cache,plugins:m.plugins};for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}function w(e,r){var t,n=y(r||{});if(n.async)try{t=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?new Error("This environment does not support async/await"):e}else t=Function;return new t(n.varName,"c",l(e,n))}e.compile=w,e.compileScope=v,e.compileScopeIntoFunction=g,e.compileToString=l,e.defaultConfig=m,e.filters=s,e.getConfig=y,e.helpers=i,e.nativeHelpers=c,e.parse=n,e.render=function(e,r,t){var n,a=y(t||{});return a.cache&&a.name&&o.get(a.name)?o.get(a.name)(r,a):(n="function"==typeof e?e:w(e,a),a.cache&&a.name&&o.define(a.name,n),n(r,a))},e.templates=o,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
