!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Sqrl={})}(this,(function(e){"use strict";function t(e){var r,n,o=new Error(e);return r=o,n=t.prototype,Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n,o}function r(e,r,n){var o=r.slice(0,n).split(/\n/),i=o.length,a=o[i-1].length+1;throw t(e+=" at line "+i+" col "+a+":\n\n  "+r.split(/\n/)[i-1]+"\n  "+Array(a).join(" ")+"^")}function n(e,t){var n=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+t.tags[1]+")","g"),o=new RegExp("([^]*?)"+t.tags[0]+"(-|_)?\\s*","g"),i=0,a="";function f(){var t,f={f:[]},c=0,u=e[i],l="c",s="r";function p(t){var n=e.slice(i,t),o=n.trim();if("f"===l)"safe"===o?f.raw=!0:f.f.push([o,""]);else if("fp"===l)f.f[f.f.length-1][1]+=o;else if("err"===l){if(o){var a=n.search(/\S/);r("invalid syntax",e,i+a)}}else f[l]=o;i=t+1}for(i+=1,"~"===u||"#"===u||"/"===u?(l="n",s=u):"!"===u||"?"===u?s=u:"*"===u?f.raw=!0:i-=1,n.lastIndex=i;null!==(t=n.exec(e));){var h=t[1],v=t[2],g=t[3],d=t[4],y=t.index;if(h)"("===h?(0===c&&("n"===l?(p(y),l="p"):"f"===l&&(p(y),l="fp")),c++):")"===h?0===--c&&"c"!==l&&(p(y),l="err"):0===c&&"|"===h?(p(y),l="f"):"=>"===h&&(p(y),i+=1,l="res");else if(v)return p(y),i=y+t[0].length,o.lastIndex=i,a=d,g&&"~"===s&&(s="s"),f.t=s,f}return r("unclosed tag",e,e.length),f}return function t(n,c){n.b=[],n.d=[];var u,l=!1,s=[];function p(e,t){if(e){var r=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");t&&(r=function(e,t){return"_"===t?String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):e.replace(/(?:[\s\uFEFF\xA0]|\r\n)$/,"")}(r,t)),a&&(r=function(e,t){return"_"===t?String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):e.replace(/^(?:[\s\uFEFF\xA0]|\r\n)/,"")}(r,a),a=""),r&&s.push(r)}}for(;null!==(u=o.exec(e));){p(u[1],u[2]),i=u.index+u[0].length;var h=f(),v=h.t;if("~"===v)h=t(h),s.push(h);else if("/"===v){if(n.n===h.n)return l?(l.d=s,n.b.push(l)):n.d=s,n;r("Helper start and end don't match",e,u.index+u[0].length)}else"#"===v?(l?(l.d=s,n.b.push(l)):n.d=s,l=h,s=[]):s.push(h)}return c&&(p(e.slice(i,e.length)),n.d=s),n}({f:[]},!0).d}t.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var o=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.clear=function(){this.cache={}},e.prototype.load=function(e){this.cache=e},e}(),i=new o({each:function(e){for(var t="",r=e.params[0],n=0;n<r.length;n++)t+=e.exec(r[n],n);return t},foreach:function(e){var t="",r=e.params[0];for(var n in r)r.hasOwnProperty(n)&&(t+=e.exec(r,n));return t}}),a=new o({if:function(e,r){if(e.f&&e.f.length)throw t("native helper 'if' can't have filters");var n="if("+e.p+"){"+v(e.d,r)+"}";if(e.b)for(var o=0;o<e.b.length;o++){var i=e.b[o];"else"===i.n?n+="else{"+v(i.d,r)+"}":"elif"===i.n&&(n+="else if("+i.p+"){"+v(i.d,r)+"}")}return n},try:function(e,r){if(e.f&&e.f.length)throw t("native helper 'try' can't have filters");if(!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw t("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+v(e.d,r)+"}",o=e.b[0];return n+="catch"+(o.res?"("+o.res+")":"")+"{"+v(o.d,r)+"}"}}),f={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function c(e){return f[e]}var u=new o({e:function(e){var t=String(e);return/[&<"']/.test(t)?t.replace(/[&<"']/g,c):t}});function l(e,t){return"var tR='';"+v(n(e,t),t).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function s(e,t,r,n,o){var i="{exec:"+h(r,t,e)+",params:["+n+"]";return o&&(i+=",name:'"+o+"'"),i+="}"}function p(e,t){for(var r="[",n=0;n<e.length;n++){var o=e[n];r+=s(t,o.res||"",o.d,o.p||"",o.n),n<e.length&&(r+=",")}return r+="]"}function h(e,t,r){return"function("+t+"){var tR='';"+v(e,r)+"return tR}"}function v(e,t){for(var r=0,n=e.length,o="";r<n;r++){var i=e[r];if("string"==typeof i){o+="tR+='"+i+"';"}else{var f=i.t,c=i.c||"",u=i.f,l=i.n||"",h=i.p||"",v=i.res||"",d=i.b;if("r"===f)!i.raw&&t.autoEscape&&(c="l('F','e')("+c+")"),o+="tR+="+g(c,u)+";";else if("~"===f)if(a.get(l))o+=a.get(l)(i,t);else{var y="l('H','"+l+"')("+s(t,v,i.d,h);d&&(y+=","+p(d,t)),o+="tR+="+g(y+=")",u)+";"}else"s"===f?o+="tR+="+g("l('H','"+l+"')("+h+")",u)+";":"!"===f&&(o+=c+";")}}return o}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r][0],o=t[r][1];e="l('F','"+n+"')("+e,o&&(e+=","+o),e+=")"}return e}function d(e,t){var r=F();for(var n in e)r[n]=e[n];return t&&(m[t]=r),r}function y(e){if("string"==typeof e)return m[e];if("object"==typeof e)return d(e);throw t("Env reference cannot be of type: "+typeof e)}function F(){return{varName:"it",autoTrim:!1,autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],loadFunction:function(e,t){return"H"===e?i.get(t):"F"===e?u.get(t):void 0},plugins:{processAST:[],processFuncString:[]}}}var m={default:F()};function b(e,t){var r=m.default;return t&&(r=y(t)),new Function(r.varName,"l",l(e,r))}e.Compile=b,e.CompileToString=l,e.Config=d,e.Env=m,e.Filters=u,e.Helpers=i,e.NativeHelpers=a,e.Parse=n,e.ParseScope=v,e.ParseScopeIntoFunction=h,e.Render=function(e,t,r,n){var o=m.default;return r&&("function"==typeof r&&(r=r(n)),o=y(r)),"function"==typeof e?e(t,o.loadFunction):b(e,o)(t,o.loadFunction)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
