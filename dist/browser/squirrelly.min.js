!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Sqrl={})}(this,(function(e){"use strict";function t(e){var r,n,a=new Error(e);return r=a,n=t.prototype,Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n,a}function r(e,r,n){var a=r.slice(0,n).split(/\n/),i=a.length,o=a[i-1].length+1;throw t(e+=" at line "+i+" col "+o+":\n\n  "+r.split(/\n/)[i-1]+"\n  "+Array(o).join(" ")+"^")}function n(e,t){var n=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+t.tags[1]+")","g"),a=new RegExp("([^]*?)"+t.tags[0]+"(-|_)?\\s*","g"),i=0,o="";function c(){var t,c={f:[]},u=0,f=e[i],s="c",l="r";function p(t){var n=e.slice(i,t),a=n.trim();if("f"===s)"safe"===a?c.raw=!0:c.f.push([a,""]);else if("fp"===s)c.f[c.f.length-1][1]+=a;else if("err"===s){if(a){var o=n.search(/\S/);r("invalid syntax",e,i+o)}}else c[s]=a;i=t+1}for(i+=1,"~"===f||"#"===f||"/"===f?(s="n",l=f):"!"===f||"?"===f?l=f:"*"===f?c.raw=!0:i-=1,n.lastIndex=i;null!==(t=n.exec(e));){var h=t[1],g=t[2],v=t[3],d=t[4],m=t.index;if(h)"("===h?(0===u&&("n"===s?(p(m),s="p"):"f"===s&&(p(m),s="fp")),u++):")"===h?0===--u&&"c"!==s&&(p(m),s="err"):0===u&&"|"===h?(p(m),s="f"):"=>"===h&&(p(m),i+=1,s="res");else if(g)return p(m),i=m+t[0].length,a.lastIndex=i,o=d,v&&"~"===l&&(l="s"),c.t=l,c}return r("unclosed tag",e,e.length),c}return function n(u,f){u.b=[],u.d=[];var s,l=!1,p=[];function h(e,r){if(e){var n=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");(n=function(e,t,r,n){var a,i;return"string"==typeof t.autoTrim?a=i=t.autoTrim:Array.isArray(t.autoTrim)&&(a=t.autoTrim[1],i=t.autoTrim[0]),r&&(a=r),n&&(i=n),"slurp"===a&&"slurp"===i||!0===a&&!0===i?e.trim():("_"===a||"slurp"===a||!0===a?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==a&&"nl"!==a||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===i||"slurp"===i||!0===i?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==i&&"nl"!==i||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(n,t,o,r))&&p.push(n)}}for(;null!==(s=a.exec(e));){h(s[1],s[2]),i=s.index+s[0].length;var g=c(),v=g.t;if("~"===v)g=n(g),p.push(g);else if("/"===v){if(u.n===g.n)return l?(l.d=p,u.b.push(l)):u.d=p,u;r("Helper start and end don't match",e,s.index+s[0].length)}else"#"===v?(l?(l.d=p,u.b.push(l)):u.d=p,l=g,p=[]):p.push(g)}return f&&(h(e.slice(i,e.length)),u.d=p),u}({f:[]},!0).d}t.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var a=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.cache[t]=e[t])},e}(),i=new a({}),o=new a({each:function(e){for(var t="",r=e.params[0],n=0;n<r.length;n++)t+=e.exec(r[n],n);return t},foreach:function(e){var t="",r=e.params[0];for(var n in r)r.hasOwnProperty(n)&&(t+=e.exec(n,r[n]));return t}}),c=new a({if:function(e,r){if(e.f&&e.f.length)throw t("native helper 'if' can't have filters");var n="if("+e.p+"){"+v(e.d,r)+"}";if(e.b)for(var a=0;a<e.b.length;a++){var i=e.b[a];"else"===i.n?n+="else{"+v(i.d,r)+"}":"elif"===i.n&&(n+="else if("+i.p+"){"+v(i.d,r)+"}")}return n},try:function(e,r){if(e.f&&e.f.length)throw t("native helper 'try' can't have filters");if(!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw t("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+v(e.d,r)+"}",a=e.b[0];return n+="catch"+(a.res?"("+a.res+")":"")+"{"+v(a.d,r)+"}"}}),u={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function f(e){return u[e]}var s=new a({e:function(e){var t=String(e);return/[&<"']/.test(t)?t.replace(/[&<"']/g,f):t}});function l(e,t){return"var tR='';"+v(n(e,t),t).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function p(e,t,r,n,a){var i="{exec:"+g(r,t,e)+",params:["+n+"]";return a&&(i+=",name:'"+a+"'"),i+="}"}function h(e,t){for(var r="[",n=0;n<e.length;n++){var a=e[n];r+=p(t,a.res||"",a.d,a.p||"",a.n),n<e.length&&(r+=",")}return r+="]"}function g(e,t,r){return"function("+t+"){var tR='';"+v(e,r)+"return tR}"}function v(e,t){for(var r=0,n=e.length,a="";r<n;r++){var i=e[r];if("string"==typeof i){a+="tR+='"+i+"';"}else{var o=i.t,u=i.c||"",f=i.f,s=i.n||"",l=i.p||"",g=i.res||"",v=i.b;if("r"===o)!i.raw&&t.autoEscape&&(u="c.l('F','e')("+u+")"),a+="tR+="+d(u,f)+";";else if("~"===o)if(c.get(s))a+=c.get(s)(i,t);else{var m="c.l('H','"+s+"')("+p(t,g,i.d,l);m+=v?","+h(v,t):",[]",a+="tR+="+d(m+=",c)",f)+";"}else"s"===o?a+="tR+="+d("c.l('H','"+s+"')("+l+",[],c)",f)+";":"!"===o&&(a+=u+";")}}return a}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r][0],a=t[r][1];e="c.l('F','"+n+"')("+e,a&&(e+=","+a),e+=")"}return e}var m={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,t){return"H"===e?o.get(t):"F"===e?s.get(t):void 0},async:!1,cache:!1,plugins:{processAST:[],processFuncString:[]}};function y(e){return{varName:e.varName||m.varName,autoTrim:e.autoTrim||m.autoTrim,autoEscape:e.autoEscape||m.autoEscape,defaultFilter:e.defaultFilter||m.defaultFilter,tags:e.tags||m.tags,l:e.l||m.l,async:e.async||m.async,cache:e.cache||m.cache,plugins:e.plugins||m.plugins,filename:e.filename,name:e.name}}function w(e,t){var r,n=y(t||{});if(n.async)try{r=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?new Error("This environment does not support async/await"):e}else r=Function;return new r(n.varName,"c",l(e,n))}e.Compile=w,e.CompileToString=l,e.Filters=s,e.Helpers=o,e.NativeHelpers=c,e.Parse=n,e.ParseScope=v,e.ParseScopeIntoFunction=g,e.Render=function(e,t,r){var n,a=y(r||{});return a.cache&&a.name&&i.get(a.name)?i.get(a.name)(t,a):(n="function"==typeof e?e:w(e,a),a.cache&&a.name&&i.define(a.name,n),n(t,a.loadFunction))},e.defaultConfig=m,e.getConfig=y,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
