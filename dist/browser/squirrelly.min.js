!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).Sqrl={})}(this,(function(e){"use strict";function r(e){var t,n,i=new Error(e);return t=i,n=r.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n,i}function t(e,t,n){var i=t.slice(0,n).split(/\n/),o=i.length,f=i[o-1].length+1;throw r(e+=" at line "+o+" col "+f+":\n\n  "+t.split(/\n/)[o-1]+"\n  "+Array(f).join(" ")+"^")}function n(e,r,n){var i=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+n+")","g"),o=new RegExp("([^]*?)"+r+"(-|_)?\\s*","g"),f=0,c="";function u(){var r,n={f:[],d:[]},u=0,a=0,l=e[f],s="c",p="r";function h(r,i){var o=e.slice(f,r)+(i||""),c=o.trim();if("f"===s)n.f[a-1][0]+=c;else if("fp"===s)n.f[a-1][1]+=c;else if("err"===s){if(c){var u=o.search(/\S/);t("invalid syntax",e,f+u)}}else s&&(n[s]=c);f=r+1}for(f+=1,"~"===l||"#"===l||"/"===l?(s="n",p=l):"!"===l||"?"===l?p=l:f-=1;null!==(r=i.exec(e));){var g=r[1],d=r[2],v=r[3],y=r[4],x=r.index;if(g)"("===g?(0===u&&("n"===s?(h(x),s="p"):"f"===s&&(h(x),s="fp")),u++):")"===g?0===--u&&"c"!==s&&(h(x),s="err"):0===u&&"|"===g?(h(x),s="f",a++,n.f[a-1]=["",""]):"=>"===g&&(h(x),f+=1,s="res");else if(d)return h(x),f+=d.length-1,o.lastIndex=f,c=y,v&&"~"===p&&(p="s"),n.t=p,n}return t("unclosed tag",e,e.length),n}return function r(n,i){n.b=[];var a,l=!1,s=[];function p(e,r){if(e){var t=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");r&&(t=function(e,r){return"_"===r?String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):e.replace(/(?:[\s\uFEFF\xA0]|\r\n)$/,"")}(t,r)),c&&(t=function(e,r){return"_"===r?String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):e.replace(/^(?:[\s\uFEFF\xA0]|\r\n)/,"")}(t,c),c=""),s.push(t)}}for(;null!==(a=o.exec(e));){p(a[1],a[2]),f=a.index+a[0].length;var h=u(),g=h.t;if("~"===g)h=r(h),s.push(h);else if("/"===g){if(n.n===h.n)return l?(l.d=s,n.b.push(l)):n.d=s,n;t("Helper start and end don't match",e,a.index+a[0].length)}else"#"===g?(l?(l.d=s,n.b.push(l)):n.d=s,l=h,s=[]):s.push(h)}return i&&(p(e.slice(f,e.length)),n.d=s),n}({f:[],d:[]},!0).d}r.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var i=function(){function e(e){this.cache=e}return e.prototype.define=function(e,r){this.cache[e]=r},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.clear=function(){this.cache={}},e.prototype.load=function(e){this.cache=e},e}(),o=new i({}),f=new i({}),c=new i({each:function(e){for(var r="",t=e.params[0],n=0;n<t.length;n++)r+=e.exec(t[n],n);return r},foreach:function(e){var r="",t=e.params[0];for(var n in t)t.hasOwnProperty(n)&&(r+=e.exec(t,n));return r}}),u=new i({if:function(e){if(e.f&&e.f.length)throw r("native helper 'if' can't have filters");var t="if("+e.p+"){"+g(e.d)+"}";if(e.b)for(var n=0;n<e.b.length;n++){var i=e.b[n];"else"===i.n?t+="else{"+g(i.d)+"}":"elif"===i.n&&(t+="else if("+i.p+"){"+g(i.d)+"}")}return t}}),a=new i({});function l(e,r,t){return"var tR='';"+g(n(e,r,t)).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function s(e,r,t,n){var i="{exec:"+h(r,e)+",params:["+t+"]";return n&&(i+=",name:'"+n+"'"),i+="}"}function p(e){for(var r="[",t=0;t<e.length;t++){var n=e[t];r+=s(n.res||"",n.d||[],n.p||"",n.n||""),t<e.length&&(r+=",")}return r+="]"}function h(e,r){return"function("+r+"){var tR='';"+g(e)+"return tR}"}function g(e){for(var r=0,t=e.length,n="";r<t;r++){var i=e[r];if("string"==typeof i){n+="tR+='"+i+"';"}else{var o=i.t,f=i.c||"",c=i.f||[],a=i.n||"",l=i.p||"",h=i.res||"",g=i.b||[];if("r"===o)n+="tR+="+d(f,c)+";";else if("~"===o)if(u.get(a))n+=u.get(a)(i);else{var v="Sqrl.H.get('"+a+"')("+s(h,i.d,l);g&&(v+=","+p(g)),n+="tR+="+(v=d(v+=")",c))+";"}else"s"===o?n+="tR+="+d("Sqrl.H.get('"+a+"')("+l+")",c)+";":"!"===o&&(n+=f+";")}}return n}function d(e,r){for(var t=0;t<r.length;t++){var n=r[t][0],i=r[t][1];e="Sqrl.F.get('"+n+"')("+e,i&&(e+=","+i),e+=")"}return e}function v(e,r,t){return new Function("it","Sqrl",l(e,r,t))}e.Compile=v,e.CompileToString=l,e.Config=function(e,r){},e.F=a,e.H=c,e.L=o,e.NH=u,e.P=f,e.Parse=n,e.ParseScope=g,e.ParseScopeIntoFunction=h,e.Render=function(e,r){return v(e,"{{","}}")(r,{H:c,F:a})},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
