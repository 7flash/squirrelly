!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Sqrl={})}(this,(function(e){"use strict";function t(e){var r,n,a=new Error(e);return r=a,n=t.prototype,Object.setPrototypeOf?Object.setPrototypeOf(r,n):r.__proto__=n,a}function r(e,r,n){var a=r.slice(0,n).split(/\n/),c=a.length,i=a[c-1].length+1;throw t(e+=" at line "+c+" col "+i+":\n\n  "+r.split(/\n/)[c-1]+"\n  "+Array(i).join(" ")+"^")}t.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var n=new Function("return this;")().Promise;function a(e,n){var a=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+n.tags[1]+")","g"),c=new RegExp("([^]*?)"+n.tags[0]+"(-|_)?\\s*","g"),i=0,o="";function s(){var t,n={f:[]},s=0,l=e[i],f="c",u="r";function p(t){var a=e.slice(i,t),c=a.trim();if("f"===f)"safe"===c?n.raw=!0:n.f.push([c,""]);else if("fp"===f)n.f[n.f.length-1][1]+=c;else if("err"===f){if(c){var o=a.search(/\S/);r("invalid syntax",e,i+o)}}else n[f]=c;i=t+1}for(i+=1,"~"===l||"#"===l||"/"===l?(f="n",u=l):"!"===l||"?"===l?u=l:"*"===l?n.raw=!0:i-=1,a.lastIndex=i;null!==(t=a.exec(e));){var h=t[1],v=t[2],d=t[3],g=t[4],y=t.index;if(h)"("===h?(0===s&&("n"===f?(p(y),f="p"):"f"===f&&(p(y),f="fp")),s++):")"===h?0===--s&&"c"!==f&&(p(y),f="err"):0===s&&"|"===h?(p(y),f="f"):"=>"===h&&(p(y),i+=1,f="res");else if(v)return p(y),i=y+t[0].length,c.lastIndex=i,o=g,d&&"~"===u&&(u="s"),n.t=u,n}return r("unclosed tag",e,e.length),n}return function a(l,f){l.b=[],l.d=[];var u,p=!1,h=[];function v(e,t){if(e){var r=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");(r=function(e,t,r,n){var a,c;return"string"==typeof t.autoTrim?a=c=t.autoTrim:Array.isArray(t.autoTrim)&&(a=t.autoTrim[1],c=t.autoTrim[0]),r&&(a=r),n&&(c=n),"slurp"===a&&"slurp"===c||!0===a&&!0===c?e.trim():("_"===a||"slurp"===a||!0===a?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==a&&"nl"!==a||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===c||"slurp"===c||!0===c?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==c&&"nl"!==c||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(r,n,o,t))&&h.push(r)}}for(;null!==(u=c.exec(e));){v(u[1],u[2]),i=u.index+u[0].length;var d=s(),g=d.t;if("~"===g)d=a(d),h.push(d);else if("/"===g){if(l.n===d.n)return p?(p.d=h,l.b.push(p)):l.d=h,l;r("Helper start and end don't match",e,u.index+u[0].length)}else"#"===g?(p?(p.d=h,l.b.push(p)):l.d=h,p=d,h=[]):h.push(d)}if(!f)throw t('unclosed helper "'+l.n+'"');return(v(e.slice(i,e.length)),l.d=h,l)}({f:[]},!0).d}var c=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.cache[t]=e[t])},e}(),i=new c({}),o=new c({each:function(e){for(var t="",r=e.params[0],n=0;n<r.length;n++)t+=e.exec(r[n],n);return t},foreach:function(e){var t="",r=e.params[0];for(var n in r)r.hasOwnProperty(n)&&(t+=e.exec(n,r[n]));return t},include:function(e,r,n){if(r&&r.length>0)throw t("Helper 'include' doesn't accept blocks");var a=i.get(e.params[0]);if(!a)throw t('Could not fetch template "'+e.params[0]+'"');return a(e.params[1],n)},extends:function(e,r,n){var a=e.params[1]||{};a.content=e.exec();for(var c=0;c<r.length;c++){var o=r[c];a[o.name]=o.exec()}var s=i.get(e.params[0]);if(!s)throw t('Could not fetch template "'+e.params[0]+'"');return s(a,n)}}),s=new c({if:function(e,r){if(e.f&&e.f.length)throw t("native helper 'if' can't have filters");var n="if("+e.p+"){"+g(e.d,r)+"}";if(e.b)for(var a=0;a<e.b.length;a++){var c=e.b[a];"else"===c.n?n+="else{"+g(c.d,r)+"}":"elif"===c.n&&(n+="else if("+c.p+"){"+g(c.d,r)+"}")}return n},try:function(e,r){if(e.f&&e.f.length)throw t("native helper 'try' can't have filters");if(!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw t("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+g(e.d,r)+"}",a=e.b[0];return n+="catch"+(a.res?"("+a.res+")":"")+"{"+g(a.d,r)+"}"},block:function(e,r){if(e.f&&e.f.length)throw t("native helper 'block' can't have filters");var n="if(!"+r.varName+"["+e.p+"]){tR+=("+d(e.d,"",r)+")()}else{tR+="+r.varName+"["+e.p+"]}";if(e.b&&e.b.length)throw t("native helper 'block' doesn't accept blocks");return n}}),l={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function f(e){return l[e]}var u=new c({e:function(e){var t=String(e);return/[&<"']/.test(t)?t.replace(/[&<"']/g,f):t}});function p(e,t){return"var tR='';"+g(a(e,t),t).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"if(cb){return cb(null,tR)} return tR"}function h(e,t,r,n,a){var c="{exec:"+(e.async?"async ":"")+d(r,t,e)+",params:["+n+"]";return a&&(c+=",name:'"+a+"'"),c+="}"}function v(e,t){for(var r="[",n=0;n<e.length;n++){var a=e[n];r+=h(t,a.res||"",a.d,a.p||"",a.n),n<e.length&&(r+=",")}return r+="]"}function d(e,t,r){return"function("+t+"){var tR='';"+g(e,r)+"return tR}"}function g(e,t){for(var r=0,n=e.length,a="";r<n;r++){var c=e[r];if("string"==typeof c){a+="tR+='"+c+"';"}else{var i=c.t,o=c.c||"",l=c.f,f=c.n||"",u=c.p||"",p=c.res||"",d=c.b;if("r"===i)!c.raw&&t.autoEscape&&(o="c.l('F','e')("+o+")"),a+="tR+="+y(o,l,t)+";";else if("~"===i)if(s.get(f))a+=s.get(f)(c,t);else{var g=(t.async&&t.asyncHelpers&&t.asyncHelpers.includes(f)?"await ":"")+"c.l('H','"+f+"')("+h(t,p,c.d,u);g+=d?","+v(d,t):",[]",a+="tR+="+y(g+=",c)",l,t)+";"}else"s"===i?a+="tR+="+y((t.async&&t.asyncHelpers&&t.asyncHelpers.includes(f)?"await ":"")+"c.l('H','"+f+"')({params:["+u+"]},[],c)",l,t)+";":"!"===i&&(a+=o+";")}}return a}function y(e,t,r){for(var n=0;n<t.length;n++){var a=t[n][0],c=t[n][1];r.async&&r.asyncFilters&&r.asyncFilters.includes(a)&&(e="await "+e),e="c.l('F','"+a+"')("+e,c&&(e+=","+c),e+=")"}return e}var m={varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],l:function(e,t){return"H"===e?o.get(t):"F"===e?u.get(t):void 0},async:!1,asyncHelpers:["include","includeFile"],cache:!1,plugins:{processAST:[],processFuncString:[]}};function w(e,t){var r={varName:m.varName,autoTrim:m.autoTrim,autoEscape:m.autoEscape,defaultFilter:m.defaultFilter,tags:m.tags,l:m.l,async:m.async,cache:m.cache,plugins:m.plugins};if(t)for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);if(e)for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);return r}function b(e,t){var r,n=w(t||{});if(n.async)try{r=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?new Error("This environment does not support async/await"):e}else r=Function;return new r(n.varName,"c","cb",p(e,n))}function x(e,t){var r;return t.cache&&t.name&&i.get(t.name)?i.get(t.name):(r="function"==typeof e?e:b(e,t),t.cache&&t.name&&i.define(t.name,r),r)}e.compile=b,e.compileScope=g,e.compileScopeIntoFunction=d,e.compileToString=p,e.defaultConfig=m,e.filters=u,e.getConfig=w,e.helpers=o,e.nativeHelpers=s,e.parse=a,e.render=function(e,r,a,c){var i=w(a||{});if(!i.async)return x(e,i)(r,i);if(!c){if("function"==typeof n)return new n((function(t,n){try{t(x(e,i)(r,i))}catch(e){n(e)}}));throw t("Please provide a callback function, this env doesn't support Promises")}try{x(e,i)(r,i,c)}catch(e){return c(e)}},e.templates=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
