!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Sqrl={})}(this,(function(e){"use strict";function t(e){var n,r,i=new Error(e);return n=i,r=t.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__=r,i}function n(e,n,r){var i=n.slice(0,r).split(/\n/),o=i.length,c=i[o-1].length+1;throw t(e+=" at line "+o+" col "+c+":\n\n  "+n.split(/\n/)[o-1]+"\n  "+Array(c).join(" ")+"^")}function r(e,t){var r=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+t.tags[1]+")","g"),i=new RegExp("([^]*?)"+t.tags[0]+"(-|_)?\\s*","g"),o=0,c="";function a(){var t,a={f:[]},f=0,u=e[o],l="c",s="r";function p(t){var r=e.slice(o,t),i=r.trim();if("f"===l)"safe"===i?a.raw=!0:a.f.push([i,""]);else if("fp"===l)a.f[a.f.length-1][1]+=i;else if("err"===l){if(i){var c=r.search(/\S/);n("invalid syntax",e,o+c)}}else a[l]=i;o=t+1}for(o+=1,"~"===u||"#"===u||"/"===u?(l="n",s=u):"!"===u||"?"===u?s=u:"*"===u?a.raw=!0:o-=1,r.lastIndex=o;null!==(t=r.exec(e));){var h=t[1],g=t[2],v=t[3],d=t[4],y=t.index;if(h)"("===h?(0===f&&("n"===l?(p(y),l="p"):"f"===l&&(p(y),l="fp")),f++):")"===h?0===--f&&"c"!==l&&(p(y),l="err"):0===f&&"|"===h?(p(y),l="f"):"=>"===h&&(p(y),o+=1,l="res");else if(g)return p(y),o=y+t[0].length,i.lastIndex=o,c=d,v&&"~"===s&&(s="s"),a.t=s,a}return n("unclosed tag",e,e.length),a}return function t(r,f){r.b=[],r.d=[];var u,l=!1,s=[];function p(e,t){if(e){var n=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");t&&(n=function(e,t){return"_"===t?String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):e.replace(/(?:[\s\uFEFF\xA0]|\r\n)$/,"")}(n,t)),c&&(n=function(e,t){return"_"===t?String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):e.replace(/^(?:[\s\uFEFF\xA0]|\r\n)/,"")}(n,c),c=""),n&&s.push(n)}}for(;null!==(u=i.exec(e));){p(u[1],u[2]),o=u.index+u[0].length;var h=a(),g=h.t;if("~"===g)h=t(h),s.push(h);else if("/"===g){if(r.n===h.n)return l?(l.d=s,r.b.push(l)):r.d=s,r;n("Helper start and end don't match",e,u.index+u[0].length)}else"#"===g?(l?(l.d=s,r.b.push(l)):r.d=s,l=h,s=[]):s.push(h)}return f&&(p(e.slice(o,e.length)),r.d=s),r}({f:[]},!0).d}t.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var i=function(){function e(e){this.cache=e}return e.prototype.define=function(e,t){this.cache[e]=t},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.clear=function(){this.cache={}},e.prototype.load=function(e){this.cache=e},e}(),o=new i({}),c=new i({each:function(e){for(var t="",n=e.params[0],r=0;r<n.length;r++)t+=e.exec(n[r],r);return t},foreach:function(e){var t="",n=e.params[0];for(var r in n)n.hasOwnProperty(r)&&(t+=e.exec(n,r));return t}}),a=new i({if:function(e,n){if(e.f&&e.f.length)throw t("native helper 'if' can't have filters");var r="if("+e.p+"){"+v(e.d,n)+"}";if(e.b)for(var i=0;i<e.b.length;i++){var o=e.b[i];"else"===o.n?r+="else{"+v(o.d,n)+"}":"elif"===o.n&&(r+="else if("+o.p+"){"+v(o.d,n)+"}")}return r},try:function(e,n){if(e.f&&e.f.length)throw t("native helper 'try' can't have filters");if(!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw t("native helper 'try' only accepts 1 block, 'catch'");var r="try{"+v(e.d,n)+"}",i=e.b[0];return r+="catch"+(i.res?"("+i.res+")":"")+"{"+v(i.d,n)+"}"}}),f={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function u(e){return f[e]}var l=new i({e:function(e){var t=String(e);return/[&<"']/.test(t)?t.replace(/[&<"']/g,u):t}});function s(e,t){return"var tR='';"+v(r(e,t),t).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function p(e,t,n,r,i){var o="{exec:"+g(n,t,e)+",params:["+r+"]";return i&&(o+=",name:'"+i+"'"),o+="}"}function h(e,t){for(var n="[",r=0;r<e.length;r++){var i=e[r];n+=p(t,i.res||"",i.d,i.p||"",i.n),r<e.length&&(n+=",")}return n+="]"}function g(e,t,n){return"function("+t+"){var tR='';"+v(e,n)+"return tR}"}function v(e,t){for(var n=0,r=e.length,i="";n<r;n++){var o=e[n];if("string"==typeof o){i+="tR+='"+o+"';"}else{var c=o.t,f=o.c||"",u=o.f,l=o.n||"",s=o.p||"",g=o.res||"",v=o.b;if("r"===c)!o.raw&&t.autoEscape&&(f="l('F','e')("+f+")"),i+="tR+="+d(f,u)+";";else if("~"===c)if(a.get(l))i+=a.get(l)(o,t);else{var y="l('H','"+l+"')("+p(t,g,o.d,s);v&&(y+=","+h(v,t)),i+="tR+="+d(y+=")",u)+";"}else"s"===c?i+="tR+="+d("l('H','"+l+"')("+s+")",u)+";":"!"===c&&(i+=f+";")}}return i}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n][0],i=t[n][1];e="l('F','"+r+"')("+e,i&&(e+=","+i),e+=")"}return e}var y={varName:"it",autoTrim:!1,autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],loadFunction:function(e,t){return"T"===e?o.get(t):"H"===e?c.get(t):"F"===e?l.get(t):void 0},plugins:{processAST:[],processFuncString:[]}},F={cache:{default:y},define:function(e,t){for(var n in this.cache[e]||(this.cache[e]=y),t)this.cache[e][n]=t[n]},get:function(e){return this.cache[e]},remove:function(e){delete this.cache[e]},clear:function(){this.cache={}},load:function(e){this.cache=e}};function m(e,t){var n=F.get("default");return t&&"string"==typeof t?n=F.get(t):t&&"object"==typeof t&&(n=t),new Function(n.varName,"l",s(e,n))}e.Compile=m,e.CompileToString=s,e.Env=F,e.Filters=l,e.Helpers=c,e.NativeHelpers=a,e.Parse=r,e.ParseScope=v,e.ParseScopeIntoFunction=g,e.Render=function(e,t,n,r){var i=F.get("default");return"function"==typeof n&&(n=n(r)),"object"==typeof n?i=n:"string"==typeof n&&n.length&&(i=F.get(n)),"function"==typeof e?e(t,i.loadFunction):m(e,i)(t,i.loadFunction)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
