!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e=e||self).Sqrl={})}(this,(function(e){"use strict";function r(e){var t,n,o=new Error(e);return t=o,n=r.prototype,Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n,o}function t(e,t,n){var o=t.slice(0,n).split(/\n/),i=o.length,a=o[i-1].length+1;throw r(e+=" at line "+i+" col "+a+":\n\n  "+t.split(/\n/)[i-1]+"\n  "+Array(a).join(" ")+"^")}function n(e,r){var n=new RegExp("([|()]|=>)|'(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r'\\\\])*?'|`(?:\\\\[\\s\\w\"'\\\\`]|[^\\\\`])*?`|\"(?:\\\\[\\s\\w\"'\\\\`]|[^\\n\\r\"\\\\])*?\"|\\/\\*[^]*?\\*\\/|((\\/)?(-|_)?"+r.tags[1]+")","g"),o=new RegExp("([^]*?)"+r.tags[0]+"(-|_)?\\s*","g"),i=0,a="";function f(){var r,f={f:[]},c=0,u=e[i],s="c",l="r";function p(r){var n=e.slice(i,r),o=n.trim();if("f"===s)"safe"===o?f.raw=!0:f.f.push([o,""]);else if("fp"===s)f.f[f.f.length-1][1]+=o;else if("err"===s){if(o){var a=n.search(/\S/);t("invalid syntax",e,i+a)}}else f[s]=o;i=r+1}for(i+=1,"~"===u||"#"===u||"/"===u?(s="n",l=u):"!"===u||"?"===u?l=u:"*"===u?f.raw=!0:i-=1,n.lastIndex=i;null!==(r=n.exec(e));){var h=r[1],v=r[2],g=r[3],d=r[4],y=r.index;if(h)"("===h?(0===c&&("n"===s?(p(y),s="p"):"f"===s&&(p(y),s="fp")),c++):")"===h?0===--c&&"c"!==s&&(p(y),s="err"):0===c&&"|"===h?(p(y),s="f"):"=>"===h&&(p(y),i+=1,s="res");else if(v)return p(y),i=y+r[0].length,o.lastIndex=i,a=d,g&&"~"===l&&(l="s"),f.t=l,f}return t("unclosed tag",e,e.length),f}return function n(c,u){c.b=[],c.d=[];var s,l=!1,p=[];function h(e,t){if(e){var n=e.replace(/\\/g,"\\\\").replace(/'/g,"\\'");(n=function(e,r,t,n){var o,i;return"string"==typeof r.autoTrim?o=i=r.autoTrim:Array.isArray(r.autoTrim)&&(o=r.autoTrim[1],i=r.autoTrim[0]),t&&(o=t),n&&(i=n),"slurp"===o&&"slurp"===i||!0===o&&!0===i?e.trim():("_"===o||"slurp"===o||!0===o?e=String.prototype.trimLeft?e.trimLeft():e.replace(/^[\s\uFEFF\xA0]+/,""):"-"!==o&&"nl"!==o||(e=e.replace(/^(?:\n|\r|\r\n)/,"")),"_"===i||"slurp"===i||!0===i?e=String.prototype.trimRight?e.trimRight():e.replace(/[\s\uFEFF\xA0]+$/,""):"-"!==i&&"nl"!==i||(e=e.replace(/(?:\n|\r|\r\n)$/,"")),e)}(n,r,a,t))&&p.push(n)}}for(;null!==(s=o.exec(e));){h(s[1],s[2]),i=s.index+s[0].length;var v=f(),g=v.t;if("~"===g)v=n(v),p.push(v);else if("/"===g){if(c.n===v.n)return l?(l.d=p,c.b.push(l)):c.d=p,c;t("Helper start and end don't match",e,s.index+s[0].length)}else"#"===g?(l?(l.d=p,c.b.push(l)):c.d=p,l=v,p=[]):p.push(v)}return u&&(h(e.slice(i,e.length)),c.d=p),c}({f:[]},!0).d}r.prototype=Object.create(Error.prototype,{name:{value:"Squirrelly Error",enumerable:!1}});var o=function(){function e(e){this.cache=e}return e.prototype.define=function(e,r){this.cache[e]=r},e.prototype.get=function(e){return this.cache[e]},e.prototype.remove=function(e){delete this.cache[e]},e.prototype.reset=function(){this.cache={}},e.prototype.load=function(e){for(var r in e)e.hasOwnProperty(r)&&(this.cache[r]=e[r])},e}(),i=new o({each:function(e){for(var r="",t=e.params[0],n=0;n<t.length;n++)r+=e.exec(t[n],n);return r},foreach:function(e){var r="",t=e.params[0];for(var n in t)t.hasOwnProperty(n)&&(r+=e.exec(n,t[n]));return r}}),a=new o({if:function(e,t){if(e.f&&e.f.length)throw r("native helper 'if' can't have filters");var n="if("+e.p+"){"+v(e.d,t)+"}";if(e.b)for(var o=0;o<e.b.length;o++){var i=e.b[o];"else"===i.n?n+="else{"+v(i.d,t)+"}":"elif"===i.n&&(n+="else if("+i.p+"){"+v(i.d,t)+"}")}return n},try:function(e,t){if(e.f&&e.f.length)throw r("native helper 'try' can't have filters");if(!e.b||1!==e.b.length||"catch"!==e.b[0].n)throw r("native helper 'try' only accepts 1 block, 'catch'");var n="try{"+v(e.d,t)+"}",o=e.b[0];return n+="catch"+(o.res?"("+o.res+")":"")+"{"+v(o.d,t)+"}"}}),f={"&":"&amp;","<":"&lt;",'"':"&quot;","'":"&#39;"};function c(e){return f[e]}var u=new o({e:function(e){var r=String(e);return/[&<"']/.test(r)?r.replace(/[&<"']/g,c):r}});function s(e,r){return"var tR='';"+v(n(e,r),r).replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"return tR"}function l(e,r,t,n,o){var i="{exec:"+h(t,r,e)+",params:["+n+"]";return o&&(i+=",name:'"+o+"'"),i+="}"}function p(e,r){for(var t="[",n=0;n<e.length;n++){var o=e[n];t+=l(r,o.res||"",o.d,o.p||"",o.n),n<e.length&&(t+=",")}return t+="]"}function h(e,r,t){return"function("+r+"){var tR='';"+v(e,t)+"return tR}"}function v(e,r){for(var t=0,n=e.length,o="";t<n;t++){var i=e[t];if("string"==typeof i){o+="tR+='"+i+"';"}else{var f=i.t,c=i.c||"",u=i.f,s=i.n||"",h=i.p||"",v=i.res||"",d=i.b;if("r"===f)!i.raw&&r.autoEscape&&(c="l('F','e')("+c+")"),o+="tR+="+g(c,u)+";";else if("~"===f)if(a.get(s))o+=a.get(s)(i,r);else{var y="l('H','"+s+"')("+l(r,v,i.d,h);d&&(y+=","+p(d,r)),o+="tR+="+g(y+=")",u)+";"}else"s"===f?o+="tR+="+g("l('H','"+s+"')("+h+")",u)+";":"!"===f&&(o+=c+";")}}return o}function g(e,r){for(var t=0;t<r.length;t++){var n=r[t][0],o=r[t][1];e="l('F','"+n+"')("+e,o&&(e+=","+o),e+=")"}return e}function d(e,r){var t=m();for(var n in e)t[n]=e[n];return r&&(w[r]=t),t}function y(e){if("string"==typeof e)return w[e];if("object"==typeof e)return d(e);throw r("Env reference cannot be of type: "+typeof e)}function m(){return{varName:"it",autoTrim:[!1,"nl"],autoEscape:!0,defaultFilter:!1,tags:["{{","}}"],loadFunction:function(e,r){return"H"===e?i.get(r):"F"===e?u.get(r):void 0},async:!1,plugins:{processAST:[],processFuncString:[]}}}var w={default:m()};function b(e,r){var t,n=w.default;if(r&&(n=y(r)),n.async)try{t=new Function("return (async function(){}).constructor;")()}catch(e){throw e instanceof SyntaxError?new Error("This environment does not support async/await"):e}else t=Function;return new t(n.varName,"l",s(e,n))}e.Compile=b,e.CompileToString=s,e.Config=d,e.Env=w,e.Filters=u,e.Helpers=i,e.NativeHelpers=a,e.Parse=n,e.ParseScope=v,e.ParseScopeIntoFunction=h,e.Render=function(e,r,t,n){var o=w.default;return t&&("function"==typeof t&&(t=t(n)),o=y(t)),"function"==typeof e?e(r,o.loadFunction):b(e,o)(r,o.loadFunction)},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=squirrelly.min.js.map
